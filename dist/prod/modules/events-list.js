"use strict";(()=>{var D=Object.defineProperty;var T=(e,t,r)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var p=(e,t,r)=>(T(e,typeof t!="symbol"?t+"":t,r),r);var m=class{constructor(){p(this,"API_BASE","https://summit.onecanoe.com/api/public/v2");p(this,"API_ENDPOINT")}async sendQuery(){let t;try{t=await fetch(this.API_BASE+this.API_ENDPOINT,{method:"post",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(this.API_BODY)})}catch(s){return console.error(`Error when sending query: ${this.API_BASE}${this.API_ENDPOINT}`,s),null}return t.ok?await t.json():(console.warn(`Error when sending query: ${this.API_BASE}${this.API_ENDPOINT}`),console.warn(t,t.statusText),null)}},f=m;var c=class extends f{constructor(r){super();p(this,"API_ENDPOINT","/events");p(this,"API_BODY");p(this,"DEFAULT_EVENT_LIMIT",12);this.API_BODY=r,this.setAPIDefaults()}setAPIDefaults(){this.API_BODY.limit||(this.API_BODY.limit=this.DEFAULT_EVENT_LIMIT),this.API_BODY.start||(this.API_BODY.start=0)}async getQueryData(){let r=await this.sendQuery();if(!r)return null;let{data:s}=r;return!s||!s.length?(console.warn(`Empty response from the query: ${this.API_BASE}${this.API_ENDPOINT}`),this.emptyResponse()):s}emptyResponse(){return[]}},y=c;function d(e){try{let t=/'([^']*)'/g,r=JSON.parse(e.replace(t,'"$1"'));return Array.isArray(r)?r:e}catch{return e}}var b="data-topics-exclude";function h(e,t){if(!t||!t.length)return t;let r=e.getAttribute(b);if(!r)return t;let s=d(r);return console.log(s),t=t.filter(n=>!n.topics.some(i=>s.includes(i))),t}function u(e){return!(e.type!=="class"||!e.class_schedule||1>=e.class_schedule.sessions_count)}function A(e){var t,r;return u(e)?dayjs((t=e.class_schedule)==null?void 0:t.first_session.starts_at).format("MMM Do")+" - "+dayjs((r=e.class_schedule)==null?void 0:r.final_session.starts_at).format("MMM Do")+" ("+e.days_of_week.join(", ")+")":dayjs(e.starts_at).format("MMM Do")+" ("+e.days_of_week.join(", ")+")"}function _(e,t,r=!0){let s="h:mm A",n=dayjs(e).format(s),i=dayjs(t).format(s),a=dayjs(e).format("z");return r?`${n} - ${i} (${a})`:`${n} - ${i}`}var P=()=>{var e;(e=window.Webflow)==null||e.require("slider").redraw(),window.dispatchEvent(new Event("resize"))};var E=["category","market","id","name","event_code","tags","limit","start","topics","before","after","timezone","test_date","is_online","extended_time_available","days_of_week","location_id"];function I(e,t){let r="query-",s=r.length;for(let n of e.attributes)if(n.name.startsWith(r)){let i=n.name.substring(s);E.includes(i)&&(t.apiBody[i]=v(n.value))}}function v(e){if(/^\d+$/.test(e))return Number(e);if(!isNaN(Date.parse(e)))return new Date(e);let t=e.toLowerCase();return t==="true"?!0:t==="false"?!1:d(e)}window.addEventListener("alpine:init",()=>{let t="data-non-slider";window.Alpine.data("eventsList",function(){return{areEventsAvailable:!0,isLoading:!1,isQueryError:!1,moreEventsLoading:!1,eventsDepleted:!1,events:[],blogList:null,apiBody:{category:["marketing_event"],start:0,limit:12,name:void 0,tags:void 0,topics:void 0,before:void 0,after:void 0,is_online:void 0,extended_time_available:void 0,days_of_week:void 0,location_id:void 0},eventSlideAttr:{[":key"](){return this.event.id}},eventWebinarImage:{[":src"](){return!this.event.tags||!this.event.tags.length?null:this.event.image_src},[":alt"](){return!this.event.tags||!this.event.tags.length?null:this.event.image_alt},srcset:"",sizes:""},async init(){if(this.isLoading=!0,this.$refs.blogPostsList){let s=this.$refs.blogPostsList.querySelectorAll(":scope > div");this.blogList=s.length?s:null}await this.$nextTick(),this.setAPIParams(),this.processQuery()},setAPIParams(){this.$refs.componentEl||console.warn("`componentEl` reference not found on the main component element - eventSlider","Processing query with the default attributes of",this.apiBody),I(this.$refs.componentEl,this)},async processQuery(s=!1){var i,a;s||(this.isLoading=!0),this.areEventsAvailable=!0,this.isQueryError=!1;let n=await new y(this.apiBody).getQueryData();if(!n){this.isLoading=!1,this.isQueryError=!0,this.areEventsAvailable=!1;return}if(!n.length&&!this.blogList&&!s){this.isLoading=!1,this.areEventsAvailable=!1;return}(!n.length&&s||n.length<(this.apiBody.limit||12))&&(this.eventsDepleted=!0),n=h(this.$refs.componentEl,n),n=(n==null?void 0:n.filter(o=>!this.events.some(l=>l.id===o.id)))||[],n.forEach(o=>{o.tags&&o.tags.length&&this.setTagImage(o)}),n.length&&this.events.push(...n),this.$nextTick(()=>{this.$refs.sliderMask&&this.blogList&&this.appendBlogPostsAndShuffle()===null&&!n.length&&(this.areEventsAvailable=!1)}),this.isLoading=!1,await this.$nextTick(),(a=(i=this.$refs)==null?void 0:i.componentEl)!=null&&a.hasAttribute(t)||P()},async viewMoreEvents(){this.apiBody.start||(this.apiBody.start=0),this.apiBody.limit||(this.apiBody.limit=6),this.apiBody.start+=this.apiBody.limit,this.moreEventsLoading=!0,await this.processQuery(!0),this.moreEventsLoading=!1},getTimeRange(s,n,i=!0){return _(s,n,i)},getPresenters(s){let{presenters:n}=s;return!n||!n.length?"No presenters":n.join(", ")},appendBlogPostsAndShuffle(){if(!this.blogList)return console.warn("Trying to shuffle event slider cards when blogList is null","slider mask element -",this.$refs.sliderMask),null;let s=this.$refs.sliderMask.querySelectorAll(":scope > div");if(!s.length)return null;let n=[...s];s.forEach(l=>l.remove());let i=document.createDocumentFragment(),a=0,o=0;for(;a<n.length||o<this.blogList.length;)if(a<n.length&&(i.appendChild(n[a]),a+=1),o<this.blogList.length){let l=this.blogList[o];l.classList.add("w-slide"),i.appendChild(l),o+=1}return this.$refs.sliderMask.appendChild(i),!0},getEventDateRange(s){return A(s)},isMultiDayEvent(s){return u(s)},setTagImage(s){var g;let n=Math.random(),i=Math.floor(n*s.tags.length),a=(g=this.$refs.blogTagsList)==null?void 0:g.querySelectorAll(`img[tag_name="${s.tags[i]}"]`);if(!a||!a.length)return null;let o=Math.floor(n*a.length),l=a[o];s.image_src=l.getAttribute("src")||null,s.image_alt=l.getAttribute("alt")||""}}})});})();
